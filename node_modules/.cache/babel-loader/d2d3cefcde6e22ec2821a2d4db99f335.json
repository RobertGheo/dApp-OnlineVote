{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SmartContractAbi = void 0;\n\nconst errors_1 = require(\"../errors\");\n\nconst utils_1 = require(\"../utils\");\n\nconst function_1 = require(\"./function\");\n\nconst typesystem_1 = require(\"./typesystem\");\n\nclass SmartContractAbi {\n  constructor(registry, implementsInterfaces) {\n    this.interfaces = [];\n    this.interfaces.push(...registry.getInterfaces(implementsInterfaces));\n  }\n\n  static fromAbiPath(abiPath) {\n    return __awaiter(this, void 0, void 0, function* () {\n      let abiRegistry = yield typesystem_1.AbiRegistry.load({\n        files: [abiPath]\n      });\n      let interfaceNames = abiRegistry.interfaces.map(iface => iface.name);\n      return new SmartContractAbi(abiRegistry, interfaceNames);\n    });\n  }\n\n  static fromAbiUrl(abiUrl) {\n    return __awaiter(this, void 0, void 0, function* () {\n      let abiRegistry = yield typesystem_1.AbiRegistry.load({\n        urls: [abiUrl]\n      });\n      let interfaceNames = abiRegistry.interfaces.map(iface => iface.name);\n      return new SmartContractAbi(abiRegistry, interfaceNames);\n    });\n  }\n\n  getAllEndpoints() {\n    let endpoints = [];\n\n    for (const iface of this.interfaces) {\n      endpoints.push(...iface.endpoints);\n    }\n\n    return endpoints;\n  }\n\n  getEndpoint(name) {\n    if (name instanceof function_1.ContractFunction) {\n      name = name.name;\n    }\n\n    let result = this.getAllEndpoints().find(item => item.name === name);\n    utils_1.guardValueIsSetWithMessage(`endpoint [${name}] not found`, result);\n    return result;\n  }\n\n  getConstructorDefinition() {\n    let constructors = [];\n\n    for (const iface of this.interfaces) {\n      let constructor_definition = iface.getConstructorDefinition();\n\n      if (constructor_definition !== null) {\n        constructors.push(constructor_definition);\n      }\n    }\n\n    switch (constructors.length) {\n      case 0:\n        return null;\n\n      case 1:\n        return constructors[0];\n\n      default:\n        throw new errors_1.ErrInvariantFailed(`Found more than 1 constructor (found ${constructors.length})`);\n    }\n  }\n\n}\n\nexports.SmartContractAbi = SmartContractAbi;","map":{"version":3,"sources":["../../src/smartcontracts/abi.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAA,QAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AAEA,MAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,MAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AACA,MAAA,YAAA,GAAA,OAAA,CAAA,cAAA,CAAA;;AAGA,MAAa,gBAAb,CAA6B;AAGzB,EAAA,WAAA,CAAY,QAAZ,EAAmC,oBAAnC,EAAiE;AAFhD,SAAA,UAAA,GAAkC,EAAlC;AAGb,SAAK,UAAL,CAAgB,IAAhB,CAAqB,GAAG,QAAQ,CAAC,aAAT,CAAuB,oBAAvB,CAAxB;AACH;;AAEuB,SAAX,WAAW,CAAC,OAAD,EAAgB;;AACpC,UAAI,WAAW,GAAG,MAAM,YAAA,CAAA,WAAA,CAAY,IAAZ,CAAiB;AAAE,QAAA,KAAK,EAAE,CAAC,OAAD;AAAT,OAAjB,CAAxB;AACA,UAAI,cAAc,GAAG,WAAW,CAAC,UAAZ,CAAuB,GAAvB,CAA2B,KAAK,IAAI,KAAK,CAAC,IAA1C,CAArB;AACA,aAAO,IAAI,gBAAJ,CAAqB,WAArB,EAAkC,cAAlC,CAAP;AACH,K;AAAA;;AAEsB,SAAV,UAAU,CAAC,MAAD,EAAe;;AAClC,UAAI,WAAW,GAAG,MAAM,YAAA,CAAA,WAAA,CAAY,IAAZ,CAAiB;AAAE,QAAA,IAAI,EAAE,CAAC,MAAD;AAAR,OAAjB,CAAxB;AACA,UAAI,cAAc,GAAG,WAAW,CAAC,UAAZ,CAAuB,GAAvB,CAA2B,KAAK,IAAI,KAAK,CAAC,IAA1C,CAArB;AACA,aAAO,IAAI,gBAAJ,CAAqB,WAArB,EAAkC,cAAlC,CAAP;AACH,K;AAAA;;AAED,EAAA,eAAe,GAAA;AACX,QAAI,SAAS,GAAG,EAAhB;;AAEA,SAAK,MAAM,KAAX,IAAoB,KAAK,UAAzB,EAAqC;AACjC,MAAA,SAAS,CAAC,IAAV,CAAe,GAAG,KAAK,CAAC,SAAxB;AACH;;AAED,WAAO,SAAP;AACH;;AAED,EAAA,WAAW,CAAC,IAAD,EAAgC;AACvC,QAAI,IAAI,YAAY,UAAA,CAAA,gBAApB,EAAsC;AAClC,MAAA,IAAI,GAAG,IAAI,CAAC,IAAZ;AACH;;AACD,QAAI,MAAM,GAAG,KAAK,eAAL,GAAuB,IAAvB,CAA4B,IAAI,IAAI,IAAI,CAAC,IAAL,KAAc,IAAlD,CAAb;AACA,IAAA,OAAA,CAAA,0BAAA,CAA2B,aAAa,IAAI,aAA5C,EAA2D,MAA3D;AACA,WAAO,MAAP;AACH;;AAED,EAAA,wBAAwB,GAAA;AACpB,QAAI,YAAY,GAAG,EAAnB;;AACA,SAAK,MAAM,KAAX,IAAoB,KAAK,UAAzB,EAAqC;AACjC,UAAI,sBAAsB,GAAG,KAAK,CAAC,wBAAN,EAA7B;;AACA,UAAI,sBAAsB,KAAK,IAA/B,EAAqC;AACjC,QAAA,YAAY,CAAC,IAAb,CAAkB,sBAAlB;AACH;AACJ;;AACD,YAAQ,YAAY,CAAC,MAArB;AACI,WAAK,CAAL;AACI,eAAO,IAAP;;AACJ,WAAK,CAAL;AACI,eAAO,YAAY,CAAC,CAAD,CAAnB;;AACJ;AACI,cAAM,IAAI,QAAA,CAAA,kBAAJ,CAAuB,wCAAwC,YAAY,CAAC,MAAM,GAAlF,CAAN;AANR;AAQH;;AAtDwB;;AAA7B,OAAA,CAAA,gBAAA,GAAA,gBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SmartContractAbi = void 0;\nconst errors_1 = require(\"../errors\");\nconst utils_1 = require(\"../utils\");\nconst function_1 = require(\"./function\");\nconst typesystem_1 = require(\"./typesystem\");\nclass SmartContractAbi {\n    constructor(registry, implementsInterfaces) {\n        this.interfaces = [];\n        this.interfaces.push(...registry.getInterfaces(implementsInterfaces));\n    }\n    static fromAbiPath(abiPath) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let abiRegistry = yield typesystem_1.AbiRegistry.load({ files: [abiPath] });\n            let interfaceNames = abiRegistry.interfaces.map(iface => iface.name);\n            return new SmartContractAbi(abiRegistry, interfaceNames);\n        });\n    }\n    static fromAbiUrl(abiUrl) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let abiRegistry = yield typesystem_1.AbiRegistry.load({ urls: [abiUrl] });\n            let interfaceNames = abiRegistry.interfaces.map(iface => iface.name);\n            return new SmartContractAbi(abiRegistry, interfaceNames);\n        });\n    }\n    getAllEndpoints() {\n        let endpoints = [];\n        for (const iface of this.interfaces) {\n            endpoints.push(...iface.endpoints);\n        }\n        return endpoints;\n    }\n    getEndpoint(name) {\n        if (name instanceof function_1.ContractFunction) {\n            name = name.name;\n        }\n        let result = this.getAllEndpoints().find(item => item.name === name);\n        utils_1.guardValueIsSetWithMessage(`endpoint [${name}] not found`, result);\n        return result;\n    }\n    getConstructorDefinition() {\n        let constructors = [];\n        for (const iface of this.interfaces) {\n            let constructor_definition = iface.getConstructorDefinition();\n            if (constructor_definition !== null) {\n                constructors.push(constructor_definition);\n            }\n        }\n        switch (constructors.length) {\n            case 0:\n                return null;\n            case 1:\n                return constructors[0];\n            default:\n                throw new errors_1.ErrInvariantFailed(`Found more than 1 constructor (found ${constructors.length})`);\n        }\n    }\n}\nexports.SmartContractAbi = SmartContractAbi;\n//# sourceMappingURL=abi.js.map"]},"metadata":{},"sourceType":"script"}