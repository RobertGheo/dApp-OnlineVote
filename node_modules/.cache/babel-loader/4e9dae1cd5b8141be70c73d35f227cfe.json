{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AccountOnNetwork = exports.Account = void 0;\n\nconst address_1 = require(\"./address\");\n\nconst nonce_1 = require(\"./nonce\");\n\nconst balance_1 = require(\"./balance\");\n\nconst balanceBuilder_1 = require(\"./balanceBuilder\");\n/**\n * An abstraction representing an account (user or Smart Contract) on the Network.\n */\n\n\nclass Account {\n  /**\n   * Creates an account object from an address\n   */\n  constructor(address) {\n    /**\n     * The address of the account.\n     */\n    this.address = new address_1.Address();\n    /**\n     * The nonce of the account (the account sequence number).\n     */\n\n    this.nonce = new nonce_1.Nonce(0);\n    /**\n     * The balance of the account.\n     */\n\n    this.balance = balanceBuilder_1.Egld(\"0\");\n    this.asOnNetwork = new AccountOnNetwork();\n    this.address = address;\n  }\n  /**\n   * Queries the details of the account on the Network\n   * @param provider the Network provider\n   * @param cacheLocally whether to save the query response within the object, locally\n   */\n\n\n  getAsOnNetwork(provider) {\n    let cacheLocally = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    return __awaiter(this, void 0, void 0, function* () {\n      this.address.assertNotEmpty();\n      let response = yield provider.getAccount(this.address);\n\n      if (cacheLocally) {\n        this.asOnNetwork = response;\n      }\n\n      return response;\n    });\n  }\n  /**\n   * Gets a previously saved query response\n   */\n\n\n  getAsOnNetworkCached() {\n    return this.asOnNetwork;\n  }\n  /**\n   * Synchronizes account properties (such as nonce, balance) with the ones queried from the Network\n   * @param provider the Network provider\n   */\n\n\n  sync(provider) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this.getAsOnNetwork(provider, true);\n      this.nonce = this.asOnNetwork.nonce;\n      this.balance = this.asOnNetwork.balance;\n    });\n  }\n  /**\n   * Increments (locally) the nonce (the account sequence number).\n   */\n\n\n  incrementNonce() {\n    this.nonce = this.nonce.increment();\n  }\n  /**\n   * Gets then increments (locally) the nonce (the account sequence number).\n   */\n\n\n  getNonceThenIncrement() {\n    let nonce = this.nonce;\n    this.nonce = this.nonce.increment();\n    return nonce;\n  }\n  /**\n   * Converts the account to a pretty, plain JavaScript object.\n   */\n\n\n  toJSON() {\n    return {\n      address: this.address.bech32(),\n      nonce: this.nonce.valueOf(),\n      balance: this.balance.toString()\n    };\n  }\n\n}\n\nexports.Account = Account;\n/**\n * A plain view of an account, as queried from the Network.\n */\n\nclass AccountOnNetwork {\n  constructor(init) {\n    this.address = new address_1.Address();\n    this.nonce = new nonce_1.Nonce(0);\n    this.balance = balanceBuilder_1.Egld(0);\n    this.code = \"\";\n    this.userName = \"\";\n    Object.assign(this, init);\n  }\n\n  static fromHttpResponse(payload) {\n    let result = new AccountOnNetwork();\n    result.address = new address_1.Address(payload[\"address\"] || 0);\n    result.nonce = new nonce_1.Nonce(payload[\"nonce\"] || 0);\n    result.balance = balance_1.Balance.fromString(payload[\"balance\"]);\n    result.code = payload[\"code\"];\n    result.userName = payload[\"username\"];\n    return result;\n  }\n\n}\n\nexports.AccountOnNetwork = AccountOnNetwork;","map":{"version":3,"sources":["../src/account.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AccountOnNetwork = exports.Account = void 0;\nconst address_1 = require(\"./address\");\nconst nonce_1 = require(\"./nonce\");\nconst balance_1 = require(\"./balance\");\nconst balanceBuilder_1 = require(\"./balanceBuilder\");\n/**\n * An abstraction representing an account (user or Smart Contract) on the Network.\n */\nclass Account {\n    /**\n     * Creates an account object from an address\n     */\n    constructor(address) {\n        /**\n         * The address of the account.\n         */\n        this.address = new address_1.Address();\n        /**\n         * The nonce of the account (the account sequence number).\n         */\n        this.nonce = new nonce_1.Nonce(0);\n        /**\n         * The balance of the account.\n         */\n        this.balance = balanceBuilder_1.Egld(\"0\");\n        this.asOnNetwork = new AccountOnNetwork();\n        this.address = address;\n    }\n    /**\n     * Queries the details of the account on the Network\n     * @param provider the Network provider\n     * @param cacheLocally whether to save the query response within the object, locally\n     */\n    getAsOnNetwork(provider, cacheLocally = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.address.assertNotEmpty();\n            let response = yield provider.getAccount(this.address);\n            if (cacheLocally) {\n                this.asOnNetwork = response;\n            }\n            return response;\n        });\n    }\n    /**\n     * Gets a previously saved query response\n     */\n    getAsOnNetworkCached() {\n        return this.asOnNetwork;\n    }\n    /**\n     * Synchronizes account properties (such as nonce, balance) with the ones queried from the Network\n     * @param provider the Network provider\n     */\n    sync(provider) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.getAsOnNetwork(provider, true);\n            this.nonce = this.asOnNetwork.nonce;\n            this.balance = this.asOnNetwork.balance;\n        });\n    }\n    /**\n     * Increments (locally) the nonce (the account sequence number).\n     */\n    incrementNonce() {\n        this.nonce = this.nonce.increment();\n    }\n    /**\n     * Gets then increments (locally) the nonce (the account sequence number).\n     */\n    getNonceThenIncrement() {\n        let nonce = this.nonce;\n        this.nonce = this.nonce.increment();\n        return nonce;\n    }\n    /**\n     * Converts the account to a pretty, plain JavaScript object.\n     */\n    toJSON() {\n        return {\n            address: this.address.bech32(),\n            nonce: this.nonce.valueOf(),\n            balance: this.balance.toString(),\n        };\n    }\n}\nexports.Account = Account;\n/**\n * A plain view of an account, as queried from the Network.\n */\nclass AccountOnNetwork {\n    constructor(init) {\n        this.address = new address_1.Address();\n        this.nonce = new nonce_1.Nonce(0);\n        this.balance = balanceBuilder_1.Egld(0);\n        this.code = \"\";\n        this.userName = \"\";\n        Object.assign(this, init);\n    }\n    static fromHttpResponse(payload) {\n        let result = new AccountOnNetwork();\n        result.address = new address_1.Address(payload[\"address\"] || 0);\n        result.nonce = new nonce_1.Nonce(payload[\"nonce\"] || 0);\n        result.balance = balance_1.Balance.fromString(payload[\"balance\"]);\n        result.code = payload[\"code\"];\n        result.userName = payload[\"username\"];\n        return result;\n    }\n}\nexports.AccountOnNetwork = AccountOnNetwork;\n//# sourceMappingURL=account.js.map"]},"metadata":{},"sourceType":"script"}